

The route_output() failed to check whether the sa_family of socket address is AF_INET6 or not, then there is no guerantee that the length of the socket is valid.
In the PoC, the length of the address is assigned to 4 and it could trigger sa_copy(). In sa_copy() if the family is AF_INET6 then source adress will be copied to destination and the size to be copied is sizeof(struct sockaddr_in6) which is 28.
